---
# This is direct conversion from old api/*/spec.json files
# using https://www.json2yaml.com/
#
# Next step: swagger.

endpoints:
  - title: Federation node handshake
    path: "/nodes/{nodeID}/handshake"
    entrypoint: nodeHandshake
    parameters:
      path:
      - name: nodeID
        type: uint64
        required: true
        title: NodeID
    apis:
      - name: initialize
        method: POST
        title: Initialize the handshake step with node B
        path: ""
        parameters:
          post:
            - name: nodeURI
              type: string
              required: true
              title: Node A node URI
            - name: tokenB
              type: string
              required: true
              title: Node B auth token
            - name: nodeIDB
              type: uint64
              required: true
              title: Node B nodeID

  - title: Federation nodes
    path: "/nodes"
    entrypoint: node
    apis:
      - name: create
        method: POST
        title: Create a new federation node
        path: ""
        parameters:
          post:
            # @todo remove this
            - name: myDomain
              type: string
              required: false
              title: "[TMP] field that determines my domain"

            - name: domain
              type: string
              required: false
              title: Node B domain
            - name: name
              type: string
              required: false
              title: Name for this node
            - name: adminContact
              type: string
              required: false
              title: Node B admin contact email
            - name: nodeURI
              type: string
              required: false
              title: Node A URI

      - name: pair
        method: POST
        title: Initialize the pairing process between the two nodes
        path: "/{nodeID}/pair"
        parameters:
          path:
            - name: nodeID
              type: uint64
              required: true
              title: NodeID

      - name: handshake confirm
        method: POST
        title: Confirm the requested handshake
        path: "/{nodeID}/handshake-confirm"
        parameters:
          path:
            - name: nodeID
              type: uint64
              required: true
              title: NodeID

      - name: handshake complete
        method: POST
        title: Complete the handshake
        path: "/{nodeID}/handshake-complete"
        parameters:
          path:
            - name: nodeID
              type: uint64
              required: true
              title: NodeID

          post:
            - name: tokenA
              type: string
              required: true
              title: Node A token

  - title: Modules
    description: Federation module definitions
    entrypoint: module
    path: "/structure/module"
    authentication: []
    apis:
      - name: read
        method: GET
        title: Read federated module
        path: "/{moduleID}"
        parameters:
          path:
            - type: uint64
              name: moduleID
              required: true
              title: Module ID
